window.PSE=window.PSE||{};PSE.RollingSessionTimeout=function(){var t=!1,i,n,u=function(){$("#btnExtendSession").on("click",function(){$("#sessionTimeoutModal").modal("hide");console.log("Resetting rolling timeout");timeoutInSeconds=timeoutThresholdMinutes*60;t=!1});$("#btnEndSession").on("click",function(){console.log("User initiated logout");window.clearInterval(n);r()})},r=function(){$.ajax({url:"/api/pseauthentication/logout",type:"GET",datatype:"json",contenttype:"application/json; charset=utf-8",data:null,context:this,success:function(){window.location="/login"},error:function(){console.log("error")}})},f=function(){var f=new Date,u;f<=i?(timeoutInSeconds--,timeoutInSeconds<=30&&(t||(console.log("Showing alert now.."),u=Math.ceil((i-f)/6e4),u<timeoutThresholdMinutes&&$("#extensionMinutes").text(u),t=!0,$("#sessionTimeoutModal").modal({escapeClose:!1,clickClose:!1,showClose:!1})),$("#secondsRemaining").text(timeoutInSeconds)),timeoutInSeconds<=0&&(console.log("Rolling timeout forced logout"),window.clearInterval(n),r())):(console.log("Token expiry forced logout"),window.clearInterval(n),r())},e=function(t){typeof t!="undefined"&&t!=""&&(timeoutThresholdMinutes=parseInt(t),timeoutInSeconds=timeoutThresholdMinutes*60,$("#extensionMinutes").text(t),u(),$.ajax({url:"/api/pseauthentication/signinstatus",type:"GET",datatype:"json",contenttype:"application/json; charset=utf-8",data:null,context:this,success:function(t){t.IsLoggedIn&&(i=new Date(t.LoginExpiresUtc+" UTC"),console.log("Rolling session timeout is active"),n=window.setInterval(f,1e3))},error:function(){console.log("error")}}))};return{rollingSessionTimeOutCheck:e}}();